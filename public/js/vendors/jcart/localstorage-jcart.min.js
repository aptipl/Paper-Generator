function addToStorage(e,t){if(localData=localStorage.getItem(t+"Storage"),"null"!==localData&&localData)var a=JSON.parse(localData);else var a=new Array;productID=e.parent().next().val(),productName=e.parent().next().attr("data-name"),productPrice=e.parent().next().attr("data-price"),productImg=e.parent().next().attr("data-img"),productQty=1,$.each(a,function(e,o){null!==o&&o.id===productID&&("cart"===t&&(productQty=o.qty+1),delete a[e])}),a.push({id:productID,name:productName,price:productPrice,img:productImg,qty:productQty}),localStorage.setItem(t+"Storage",JSON.stringify(a))}function updateDetails(e){Container=JSON.parse(localStorage.getItem(e+"Storage")),totalSum=0,nr=0,wishTbody="",cartTbody="",Container&&$.each(Container,function(t,a){null!==a&&(totalPrice=a.qty*a.price,totalSum+=totalPrice,"cart"==e?nr+=a.qty:nr++)}),$("."+e+"Count").text(nr),nr<1?("wish"==e&&(wishTbody="<tr><td>Your wish list is empty !</td></tr>",$("#wishContainer tbody").html(wishTbody)),"cart"==e&&($(".subtotal").text("0.00"),$(".vat").text("0.00"),$(".total").text("0.00"),cartTbody='<tr><td colspan="7">Your cart is empty!</td></tr>',$(".cartContainer tbody").html(cartTbody),$("#cartContainer tbody").html(cartTbody))):("wish"==e&&(Container&&$.each(Container,function(e,t){null!==t&&(wishTbody+='<tr><td style="width:5%"><a href="'+productPage+"?productid="+t.id+'"><img class="img-rounded" src="'+imgPath+t.img+'" alt="" width="45"></a></td><td style="width:65%"><h5><a href="'+productPage+"?productid="+t.id+'">'+t.name+'</a></h5></td><td style="width:25%" class="text-right"><strong>'+cartCurrency+" "+t.price+'</strong></td><td style="width:5%"><a href="#" role="button" class="close pull-right remove-product" title="remove" product-id='+t.id+'><i class="fa fa-times"></i></a></td></tr>')}),$("#wishContainer tbody").html(wishTbody)),"cart"==e&&(Container&&$.each(Container,function(e,t){null!==t&&(totalPrice=t.qty*t.price,cartTbody+='<tr><td style="width:5%"><a href="'+productPage+"?productid="+t.id+'"><img class="img-rounded" src="'+imgPath+t.img+'" alt="" width="45"><a></td><td style="width:65%"><h5><a href="'+productPage+"?productid="+t.id+'">'+t.name+"</a></h5><small>Quantity: "+t.qty+'</small></td><td style="width:20%" class="text-right"><strong>'+cartCurrency+totalPrice.toFixed(2)+' </strong></td><td style="width:10%"><a href = "#" role="button" class="close pull-right remove-product" data-tooltip="tooltip" title="Remove" product-id='+t.id+'><i class="fa fa-times"></i></a></td></tr>')}),total=totalSum+totalSum*cartVat,totalVat=totalSum*cartVat,$(".subtotal").text(cartCurrency+" "+totalSum.toFixed(2)),$(".vat").text(cartCurrency+" "+totalVat.toFixed(2)),$(".total").text(cartCurrency+" "+total.toFixed(2)),$(".cartContainer tbody").html(cartTbody)))}function showCheckout(){Cart=JSON.parse(localStorage.getItem("cartStorage")),cartTbody="",totalSum=0,Cart&&$.each(Cart,function(e,t){null!==t&&(totalPrice=t.qty*t.price,cartTbody+='<tr><td style="width:5%"><img src="'+imgPath+t.img+'" alt="" width="44"></td><td style="width:35%"><h5>'+t.name+'</h5></td><td style="width:10%"><div class="input-group"><input class="form-control"value="'+t.qty+'" p-id="'+t.id+'" data-name="'+t.name+'" data-price="'+t.price+'" data-img="'+t.img+'"><span class="input-group-btn"><button class="btn btn-default updatePrice" type="button"><i class="fa fa-refresh"></i></button></span></div></td><td class="text-center">'+cartCurrency+t.price+'</td><td class="text-center">'+cartCurrency+totalPrice.toFixed(2)+' </td><td class="text-center">'+cartCurrency+(totalPrice*cartVat).toFixed(2)+' </td><td><a href="#" role="button" class="btn btn-danger pull-right remove-product" title="remove" product-id='+t.id+">Remove item</a></td></tr>")}),$("#cartContainer tbody").html(cartTbody),updateDetails("cart")}function updateCart(e){var t=e.attr("p-id"),a=parseInt(e.val());Products=JSON.parse(localStorage.getItem("cartStorage")),$.each(Products,function(e,o){null!==o&&o.id==t&&(0===a?delete Products[e]:Products[e].qty=a)}),localStorage.setItem("cartStorage",JSON.stringify(Products)),showCheckout()}cartVat=.24,cartCurrency="$",productPage="",imgPath="images/",updateDetails("wish"),$(".wish").click(function(e){e.preventDefault(),wish=$(this),wish.each(function(){addToStorage(wish,"wish")}),updateDetails("wish"),showMessage("wish")}),$(".wishMenu").click(function(e){updateDetails("wish"),e.stopPropagation()}),$(".showWish").mouseenter(function(){updateDetails("wish")}),$(".emptyWish").click(function(){localStorage.setItem("wishStorage",null),$(".wishCount").text(0)}),$("#wishContainer tbody").delegate(".remove-product","click",function(e){removeID=$(this).attr("product-id"),Wish=JSON.parse(localStorage.getItem("wishStorage")),Wish&&($.each(Wish,function(e,t){null!==t&&t.id==removeID&&delete Wish[e]}),localStorage.setItem("wishStorage",JSON.stringify(Wish))),updateDetails("wish")}),updateDetails("cart"),$(".cart").click(function(e){e.preventDefault(),cart=$(this),cart.each(function(){addToStorage(cart,"cart")}),updateDetails("cart"),showMessage("cart")}),$(".cartMenu").click(function(e){updateDetails("cart"),e.stopPropagation()}),$(".showCart").mouseenter(function(){updateDetails("cart")}),$(".emptyCart").click(function(){localStorage.setItem("cartStorage",null),updateDetails("cart")}),$(".cartContainer tbody, #cartContainer tbody").delegate(".remove-product","click",function(e){removeID=$(this).attr("product-id"),Cart=JSON.parse(localStorage.getItem("cartStorage")),Cart&&($.each(Cart,function(e,t){null!==t&&t.id==removeID&&delete Cart[e]}),localStorage.setItem("cartStorage",JSON.stringify(Cart))),updateDetails("cart"),showCheckout()}),showCheckout(),$("#cartContainer").delegate(".updatePrice","click",function(){updateCart($(this).parent().prev())});